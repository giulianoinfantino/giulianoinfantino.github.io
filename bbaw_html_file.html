<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBAW Archiv - Semantische Suche im Schleiermacher-Briefwechsel</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap');
        .font-serif { font-family: 'Merriweather', serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide Icons als einfache SVG-Komponenten
        const Search = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        );

        const Mail = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="2" y="4" width="20" height="16" rx="2"></rect>
                <path d="m22 7-10 7L2 7"></path>
            </svg>
        );

        const Calendar = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const User = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
        );

        const MapPin = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
            </svg>
        );

        const Loader2 = ({ size = 24, className = "" }) => (
            <svg className={`${className} animate-spin`} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
            </svg>
        );

        const BookOpen = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
            </svg>
        );

        const Info = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
        );

        const BBAWSemanticSearch = () => {
            const [query, setQuery] = useState('');
            const [results, setResults] = useState([]);
            const [loading, setLoading] = useState(false);
            const [initialLoading, setInitialLoading] = useState(true);
            const [letters, setLetters] = useState([]);
            const [stats, setStats] = useState({ total: 0, years: '', persons: 0 });

            const sampleLetters = [
                {
                    id: "brief_1808_001",
                    date: "1808-03-15",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Georg Andreas Reimer",
                    place: "Berlin",
                    subject: "Über die Religion und das akademische Leben",
                    content: "Mein lieber Freund! Ihre Anfrage bezüglich meiner Gedanken zur Religion und ihrer Bedeutung für das akademische Leben beschäftigt mich sehr. Die Religion ist nicht bloß eine Sache des Wissens oder des Handelns, sondern ein eigentümliches Gefühl, eine unmittelbare Anschauung des Universums. Im akademischen Kontext müssen wir bedenken, dass die wissenschaftliche Bildung und die religiöse Erfahrung sich gegenseitig bereichern können.",
                    topics: ["Religion", "Wissenschaft", "Bildung", "Universität"]
                },
                {
                    id: "brief_1810_042",
                    date: "1810-09-22",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Henriette Herz",
                    place: "Berlin",
                    subject: "Gründung der Universität Berlin",
                    content: "Verehrte Freundin! Die Gründung unserer neuen Universität schreitet voran. Es ist eine Zeit großer Hoffnung und auch großer Herausforderungen. Wilhelm von Humboldt arbeitet unermüdlich daran, eine Institution zu schaffen, die Wissenschaft und Bildung auf neue Weise verbindet. Meine Professur für Theologie gibt mir die Gelegenheit, meine Ideen zur praktischen Theologie in die Lehre einzubringen.",
                    topics: ["Universität", "Bildung", "Theologie", "Humboldt"]
                },
                {
                    id: "brief_1813_078",
                    date: "1813-05-10",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Karl Gustav von Brinckmann",
                    place: "Berlin",
                    subject: "Befreiungskriege und nationale Erhebung",
                    content: "Die gegenwärtige politische Lage erfüllt uns alle mit großen Erwartungen. Die Befreiung vom französischen Joch ist nicht nur eine politische, sondern auch eine geistige Notwendigkeit. Das deutsche Volk erwacht zu neuem Selbstbewusstsein. Als Prediger an der Dreifaltigkeitskirche sehe ich es als meine Pflicht, den Menschen in diesen schweren Zeiten Mut und Orientierung zu geben.",
                    topics: ["Politik", "Befreiungskriege", "Nation", "Predigt"]
                },
                {
                    id: "brief_1818_124",
                    date: "1818-11-03",
                    sender: "Friedrich Schleiermacher",
                    recipient: "August Boeckh",
                    place: "Berlin",
                    subject: "Über Hermeneutik und Interpretation",
                    content: "Hochgeschätzter Kollege! Ihre Überlegungen zur Philologie haben mich zu tieferen Reflexionen über die Kunst der Auslegung angeregt. Die Hermeneutik, wie ich sie verstehe, ist nicht bloß eine Technik des Textverstehens, sondern eine Kunstlehre des Verstehens überhaupt. Jede Rede, jeder Text setzt einen Autor und einen Hörer voraus, und zwischen beiden muss eine Vermittlung stattfinden.",
                    topics: ["Hermeneutik", "Philologie", "Interpretation", "Verstehen"]
                },
                {
                    id: "brief_1822_156",
                    date: "1822-07-18",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Friedrich Heinrich Christian Schwarz",
                    place: "Berlin",
                    subject: "Akademiearbeit und wissenschaftliche Gemeinschaft",
                    content: "Die Arbeit in der Akademie der Wissenschaften erfüllt mich mit großer Zufriedenheit. Der Austausch mit den Kollegen aus verschiedenen Disziplinen bereichert mein Denken. Die Akademie ist ein Ort, an dem Wissenschaft nicht isoliert betrieben wird, sondern in lebendiger Gemeinschaft gedeiht. Besonders die philosophisch-historische Klasse bietet Raum für fruchtbare Diskussionen.",
                    topics: ["Akademie", "Wissenschaft", "Gemeinschaft", "Interdisziplinarität"]
                },
                {
                    id: "brief_1825_189",
                    date: "1825-04-12",
                    sender: "Friedrich Schleiermacher",
                    recipient: "August Twesten",
                    place: "Berlin",
                    subject: "Theologische Ethik und christliche Sittenlehre",
                    content: "Ihre Fragen zur christlichen Ethik treffen einen Kernpunkt meines theologischen Denkens. Die christliche Sittenlehre kann nicht von der Dogmatik getrennt werden, sie ist vielmehr ihre praktische Konsequenz. Das sittliche Leben der christlichen Gemeinschaft erwächst aus dem gemeinsamen Glauben und der gemeinsamen Erfahrung der Erlösung. In meinen Vorlesungen versuche ich, dies meinen Studenten zu vermitteln.",
                    topics: ["Ethik", "Theologie", "Sittenlehre", "Lehre"]
                },
                {
                    id: "brief_1828_203",
                    date: "1828-02-28",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Wilhelm Dilthey (Brief über Diltheys Großvater)",
                    place: "Berlin",
                    subject: "Pädagogische Reformen und Bildungstheorie",
                    content: "Die Erziehung des Menschen ist eine der vornehmsten Aufgaben der Gesellschaft. Bildung darf nicht als bloße Wissensvermittlung verstanden werden, sondern als Entwicklung der ganzen Persönlichkeit. Die preußischen Bildungsreformen, an denen ich mitwirken durfte, zielen darauf ab, jedem Menschen die Möglichkeit zur Entfaltung seiner Anlagen zu geben. Dies gilt für das Gymnasium ebenso wie für die Universität.",
                    topics: ["Bildung", "Pädagogik", "Reform", "Persönlichkeit"]
                },
                {
                    id: "brief_1830_245",
                    date: "1830-10-05",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Karl Lachmann",
                    place: "Berlin",
                    subject: "Über das Wesen der Sprache und Übersetzung",
                    content: "Die Übersetzung von Platons Werken beschäftigt mich weiterhin intensiv. Übersetzen ist mehr als ein mechanischer Vorgang - es erfordert ein tiefes Eindringen in den Geist der fremden Sprache. Man muss dem Leser die Fremdheit des Textes spürbar machen, ohne ihn unverständlich werden zu lassen. Dies ist die dialektische Aufgabe jeder Übersetzung: Treue zum Original und Verständlichkeit für den Leser zu verbinden.",
                    topics: ["Sprache", "Übersetzung", "Platon", "Philologie"]
                },
                {
                    id: "brief_1832_278",
                    date: "1832-06-20",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Jonas Ludwig von Hess",
                    place: "Berlin",
                    subject: "Ästhetik und Kunsttheorie",
                    content: "Ihre Beobachtungen zur modernen Kunst stimmen mit meinen Überlegungen überein. Die Kunst ist ein eigener Bereich des menschlichen Geistes, der weder auf Religion noch auf Wissenschaft reduziert werden kann. In meinen Vorlesungen zur Ästhetik versuche ich zu zeigen, wie Kunst eine eigene Form der Weltaneignung darstellt. Die künstlerische Produktion und die ästhetische Rezeption sind gleichursprünglich.",
                    topics: ["Ästhetik", "Kunst", "Theorie", "Kreativität"]
                },
                {
                    id: "brief_1834_312",
                    date: "1834-01-15",
                    sender: "Friedrich Schleiermacher",
                    recipient: "Alexander von Humboldt",
                    place: "Berlin",
                    subject: "Wissenschaft und Weltanschauung",
                    content: "Hochverehrter Freund! Ihr Bericht über Ihre Forschungsreisen hat mich tief beeindruckt. Die empirische Wissenschaft, wie Sie sie betreiben, und die philosophische Reflexion, der ich mich widme, sind zwei Wege, die Welt zu verstehen. Beide sind notwendig und ergänzen sich. Die Akademie ist der richtige Ort für diesen Dialog zwischen den verschiedenen Wissenschaften. Ihr Wirken zeigt exemplarisch, wie Wissenschaft die Horizonte erweitert.",
                    topics: ["Wissenschaft", "Forschung", "Philosophie", "Weltanschauung"]
                }
            ];

            useEffect(() => {
                setTimeout(() => {
                    setLetters(sampleLetters);
                    setStats({
                        total: sampleLetters.length,
                        years: "1808-1834",
                        persons: new Set(sampleLetters.map(l => l.recipient)).size
                    });
                    setInitialLoading(false);
                }, 1000);
            }, []);

            const semanticSimilarity = (text1, text2) => {
                const normalize = (text) => text.toLowerCase()
                    .replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "")
                    .split(/\s+/)
                    .filter(word => word.length > 3);

                const words1 = normalize(text1);
                const words2 = normalize(text2);
                
                const expandWithSynonyms = (words) => {
                    const synonyms = {
                        'religion': ['glaube', 'glauben', 'religiös', 'kirche', 'theologie', 'theologisch'],
                        'wissenschaft': ['forschung', 'studium', 'gelehrsamkeit', 'wissenschaftlich', 'akademisch'],
                        'bildung': ['erziehung', 'lehre', 'unterricht', 'pädagogik', 'ausbildung'],
                        'universität': ['hochschule', 'akademie', 'institution', 'fakultät'],
                        'politik': ['politisch', 'staat', 'regierung', 'nation', 'national'],
                        'kunst': ['ästhetik', 'künstlerisch', 'schönheit', 'kreativ'],
                        'philosophie': ['philosophisch', 'denken', 'reflexion', 'metaphysik'],
                        'sprache': ['linguistik', 'philologie', 'übersetzung', 'text'],
                        'ethik': ['moral', 'sittlich', 'sittenlehre', 'tugend']
                    };

                    const expanded = new Set(words);
                    words.forEach(word => {
                        Object.keys(synonyms).forEach(key => {
                            if (word.includes(key) || key.includes(word)) {
                                synonyms[key].forEach(syn => expanded.add(syn));
                            }
                        });
                    });
                    return Array.from(expanded);
                };

                const expanded1 = expandWithSynonyms(words1);
                const expanded2 = expandWithSynonyms(words2);

                const intersection = expanded1.filter(word => expanded2.includes(word));
                const union = new Set([...expanded1, ...expanded2]);
                
                return union.size > 0 ? intersection.length / union.size : 0;
            };

            const handleSearch = () => {
                if (!query.trim()) return;

                setLoading(true);
                
                setTimeout(() => {
                    const scoredLetters = letters.map(letter => {
                        const searchableText = `${letter.subject} ${letter.content} ${letter.topics.join(' ')}`;
                        const score = semanticSimilarity(query, searchableText);
                        
                        return { ...letter, score };
                    });

                    const sortedResults = scoredLetters
                        .filter(letter => letter.score > 0.05)
                        .sort((a, b) => b.score - a.score)
                        .slice(0, 8);

                    setResults(sortedResults);
                    setLoading(false);
                }, 600);
            };

            const formatDate = (dateStr) => {
                const [year, month, day] = dateStr.split('-');
                const months = ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
                return `${day}. ${months[parseInt(month) - 1]} ${year}`;
            };

            if (initialLoading) {
                return (
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center">
                        <div className="text-center">
                            <Loader2 size={48} className="text-gray-600 mx-auto mb-4" />
                            <p className="text-gray-600">Lade Schleiermacher-Briefwechsel...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="bg-white border-b border-gray-200 shadow-sm">
                        <div className="max-w-5xl mx-auto px-6 py-6">
                            <div className="flex items-center gap-3 mb-3">
                                <BookOpen size={32} className="text-gray-700" />
                                <div>
                                    <h1 className="text-2xl font-serif font-bold text-gray-900">
                                        Archiv der Berlin-Brandenburgischen Akademie der Wissenschaften
                                    </h1>
                                    <p className="text-sm text-gray-600 mt-1">
                                        Semantische Suche im Schleiermacher-Briefwechsel (1808-1834)
                                    </p>
                                </div>
                            </div>
                            <div className="flex gap-6 text-sm text-gray-600 pt-3 border-t border-gray-200">
                                <div className="flex items-center gap-2">
                                    <Mail size={16} />
                                    <span>{stats.total} Briefe</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <Calendar size={16} />
                                    <span>{stats.years}</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <User size={16} />
                                    <span>{stats.persons} Korrespondenzpartner</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-5xl mx-auto px-6 py-8">
                        <div className="bg-blue-50 border-l-4 border-blue-600 p-4 mb-6">
                            <div className="flex gap-3">
                                <Info size={20} className="text-blue-700 flex-shrink-0 mt-0.5" />
                                <div>
                                    <h3 className="font-semibold text-gray-900 mb-1">Über diesen Prototyp</h3>
                                    <p className="text-sm text-gray-700 mb-2">
                                        Diese Demonstration zeigt innovative digitale Zugänge zu Archivbeständen der BBAW. 
                                        Die semantische Suche findet Briefe nach <strong>Bedeutung</strong>, nicht nur nach exakten Stichworten.
                                    </p>
                                    <p className="text-xs text-gray-600">
                                        Datenquelle: Basierend auf schleiermacher-digital.de (BBAW-Projekt)
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-md border border-gray-200 p-6 mb-8">
                            <div className="flex gap-3 mb-4">
                                <div className="flex-1 relative">
                                    <Search size={20} className="absolute left-3 top-3 text-gray-400" />
                                    <input
                                        type="text"
                                        value={query}
                                        onChange={(e) => setQuery(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                                        placeholder="z.B. 'religiöse Bildung', 'politische Situation', 'wissenschaftliche Gemeinschaft'"
                                        className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    />
                                </div>
                                <button
                                    onClick={handleSearch}
                                    disabled={loading || !query.trim()}
                                    className="px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded font-medium transition-colors flex items-center gap-2"
                                >
                                    {loading ? (
                                        <>
                                            <Loader2 size={20} />
                                            Suche...
                                        </>
                                    ) : (
                                        <>
                                            <Search size={20} />
                                            Suchen
                                        </>
                                    )}
                                </button>
                            </div>

                            <div className="flex flex-wrap gap-2 items-center">
                                <span className="text-xs text-gray-500">Beispielsuchen:</span>
                                {['religiöse Bildung', 'Universität Gründung', 'Hermeneutik Verstehen', 'politische Befreiung'].map(example => (
                                    <button
                                        key={example}
                                        onClick={() => setQuery(example)}
                                        className="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-xs text-gray-700 transition-colors"
                                    >
                                        {example}
                                    </button>
                                ))}
                            </div>
                        </div>

                        {results.length > 0 && (
                            <div>
                                <h2 className="text-xl font-serif font-bold text-gray-900 mb-6 pb-2 border-b-2 border-gray-300">
                                    {results.length} relevante Briefe gefunden
                                </h2>
                                
                                <div className="space-y-6">
                                    {results.map((letter) => (
                                        <article key={letter.id} className="bg-white rounded border border-gray-300 shadow-sm hover:shadow-md transition-shadow">
                                            <div className="p-6">
                                                <div className="flex items-start justify-between mb-4">
                                                    <div className="flex-1">
                                                        <h3 className="text-lg font-serif font-semibold text-gray-900 mb-3">
                                                            {letter.subject}
                                                        </h3>
                                                        <div className="flex flex-wrap gap-4 text-sm text-gray-600">
                                                            <div className="flex items-center gap-1">
                                                                <Calendar size={16} />
                                                                {formatDate(letter.date)}
                                                            </div>
                                                            <div className="flex items-center gap-1">
                                                                <User size={16} />
                                                                <span className="font-medium">{letter.sender}</span>
                                                                <span>→</span>
                                                                <span>{letter.recipient}</span>
                                                            </div>
                                                            <div className="flex items-center gap-1">
                                                                <MapPin size={16} />
                                                                {letter.place}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div className="ml-4 text-right bg-blue-50 px-4 py-2 rounded border border-blue-200">
                                                        <div className="text-xs text-gray-600 mb-1">Relevanz</div>
                                                        <div className="text-xl font-bold text-blue-700">
                                                            {(letter.score * 100).toFixed(0)}%
                                                        </div>
                                                    </div>
                                                </div>

                                                <p className="text-gray-700 leading-relaxed mb-4 text-sm border-l-2 border-gray-200 pl-4">
                                                    {letter.content.substring(0, 300)}...
                                                </p>

                                                <div className="flex items-center justify-between pt-4 border-t border-gray-200">
                                                    <div className="flex flex-wrap gap-2">
                                                        {letter.topics.map(topic => (
                                                            <span key={topic} className="px-2 py-1 bg-gray-100 text-gray-700 border border-gray-300 rounded text-xs">
                                                                {topic}
                                                            </span>
                                                        ))}
                                                    </div>
                                                    <button className="text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors">
                                                        Vollständiger Brief →
                                                    </button>
                                                </div>
                                            </div>
                                        </article>
                                    ))}
                                </div>
                            </div>
                        )}

                        {results.length === 0 && query && !loading && (
                            <div className="text-center py-12 bg-white rounded border border-gray-300">
                                <Search size={48} className="text-gray-400 mx-auto mb-4" />
                                <h3 className="text-lg font-semibold text-gray-700 mb-2">Keine Briefe gefunden</h3>
                                <p className="text-gray-500">Versuchen Sie andere Suchbegriffe oder allgemeinere Konzepte</p>
                            </div>
                        )}

                        {!query && (
                            <div className="mt-12 text-center text-gray-500 text-sm border-t border-gray-200 pt-6">
                                <p className="mb-1">
                                    Prototyp für innovative digitale Archivzugänge
                                </p>
                                <p className="text-xs text-gray-400">
                                    Entwickelt für die Bewerbung bei der Berlin-Brandenburgischen Akademie der Wissenschaften
                                </p>
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        ReactDOM.render(<BBAWSemanticSearch />, document.getElementById('root'));
    </script>
</body>
</html>